<!DOCTYPE html>
<html>
<head>
    <title>HighOnChat App</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

    <style>
      
  .notification-popup {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
}

.notification-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 999;
}
        /* Add any additional CSS styling here */
    </style>
</head>
<body>
  <!-- <div id = "imageMain"></div> -->
    <div class="container mt-5">
        <div id="chat-window" class="mb-3" style="display: none;">
            <h3 id="welcome-message"></h3>
            <ul id="messages" class="list-group"></ul>
            <form id="chat-form" class="mt-3">
                <div class="input-group">
                    <input id="chat-input" type="text" class="form-control" placeholder="Type a message...">
                    <div class="input-group-append">
                        <button type="submit" class="btn btn-primary">Send</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="container mt-5" id="image-container">
              
    </div>

    
    <!-- // Testing by HighNitin - for popup notification on user joined -->
    <!-- Add toast notification container -->
    <!-- <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1050">
      <div id="user-joined-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
          <div class="toast-header">
              <strong class="me-auto">User Joined</strong>
              <small class="text-muted">Just now</small>
              <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
          <div class="toast-body"> -->
              <!-- User joined message will appear here -->
          <!-- </div>
      </div>
  </div> -->

     <!-- Add popup notification container -->
     <!-- <div id="notification-container" class="notification-container"></div> -->

     
     <!-- // Testing by HighNitin - for popup notification on user joined -->

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const username = prompt("Hold your horses Robin Hood and enter your name?");
        if (username) {
            const socket = io();
            socket.emit('user joined', username);

            const chatWindow = document.getElementById('chat-window');
            const welcomeMessage = document.getElementById('welcome-message');
            const messages = document.getElementById('messages');

            welcomeMessage.textContent = `Welcome, ${username}!`;
            
            document.getElementById('chat-form').addEventListener('submit', (e) => {
              e.preventDefault();
              const msg = document.getElementById('chat-input').value;
              if (msg.trim() !== '') {
                socket.emit('chat message', `${username}: ${msg}`);
                document.getElementById('chat-input').value = '';
              }
            });
            
            socket.on('chat message', (msg) => {
              const li = document.createElement('li');
              li.textContent = msg;
              li.classList.add('list-group-item');
              messages.appendChild(li);
              // messages.appendChild(welcomeMessage);
            });
            
            // -------------------------------------------------------------------
            // Testing by HighNitin - for text notification on user joined
            // -------------------------------------------------------------------
            
            // socket.on('user joined', (user) => {
              //   console.log(welcomeMessage);
              // console.log("User Join", user);
              // const joinMsg = document.createElement('li');
              // joinMsg.textContent = `${user} has joined the chat`;
              // joinMsg.classList.add('list-group-item', 'text-muted');
              // messages.appendChild(joinMsg);
              
              // -------------------------------------------------------------------
              // Testing by HighNitin - for popup notification on user joined
              // -------------------------------------------------------------------
              // // Display disappearing popup notification
              // const notificationContainer = document.getElementById('notification-container');
              // const popupNotification = document.createElement('div');
              // popupNotification.className = 'alert alert-success notification-popup';
              // popupNotification.textContent = `${user} has joined the chat`;
              // notificationContainer.appendChild(popupNotification);
              // -------------------------------------------------------------------
              // Testing by HighNitin - for popup notification on user joined
              // -------------------------------------------------------------------
              // Display toast notification
            //   const userJoinedToast = new bootstrap.Toast(document.getElementById('user-joined-toast'));
            // const toastBody = document.querySelector('#user-joined-toast .toast-body');
            // toastBody.textContent = `${user} has joined the chat`;
            // userJoinedToast.show();
        // });


            // setTimeout(() => {
            //     popupNotification.remove();
            // }, 3000); // Remove after 3 seconds
        // });
        chatWindow.style.display = 'block';
        // const imageContainerForError = document.getElementById("image-container")
        // const imageMainForImage = document.getElementById("imageMain");
        // imageMainForImage.style.display = 'none';

        // bodyMainForImage.appendChild = imageContainerForError;

      } else {
        // Handle case when the user cancels the prompt
        // You can redirect them or show an error message
            // chatWindow.style.display = 'block';
            // const imageContainerForError = document.getElementById("image-container")
            // const imageMainForImage = document.getElementById("imageMain");
            // imageMainForImage.appendChild = imageContainerForError;
        }
    </script>
</body>
</html>
